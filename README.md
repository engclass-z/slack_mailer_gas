# slack_mailer_gas

GAS を利用してメールの自動返信を行うスクリプト

# 利用方法

！本プログラムは自己責任でご利用をお願いします

## 利用手順

1. 予め本プログラムを使いたい Google アカウントでログインをしておく
1. [Apps Script](https://script.google.com/home/my) を開く
1. 新しいプロジェクトボタンを押す
1. 上部の `無題のプロジェクト` の箇所を、自分の目的に合わせたわかりやすい名前にする(任意)
1. 左側の `コード.gs` の箇所をわかりやすい名前にする(任意)
1. 中央のプログラムが書かれている場所の記載 `function myFunction(){}` をすべて [gs ファイルの中身](https://github.com/engclass-z/gas_mail_replier/blob/main/dist/app.gs) に置き換える
1. プログラム上部の、処理対象メールの条件や、メール件名、本文の内容を必要に応じて書き換える
1. `プロジェクトを保存` ボタンを押す
1. 実行ボタンを押す
   - 承認が必要です、と表示されたら、画面指示に従い承認を行う
1. 画面下部の実行ログの箇所に `エラー` が表示されていないことを確認する
1. 画面左の `トリガー` ボタンを押し、右下の `トリガーを追加` ボタンを押す
1. メール返信を行いたい周期を選択する
   - 例: 即時返信を行いたい場合
     - 時間ベースのトリガーのタイプを `分ベースのタイマー` にする
     - 時間の間隔を 1 分おきにする
1. 設定完了

## 稼働を完全に終了する場合

1. [Apps Script](https://script.google.com/home/my) を開く
1. 利用手順の項で作成したプロジェクトの三点リーダメニューの中から削除を選択
1. 完了

## 稼働を一時停止する場合

1. [Apps Script](https://script.google.com/home/my) を開く
1. 利用手順の項で作成したプロジェクトを選択
1. 画面左の `トリガー` ボタンを押し、現在設定されているトリガーを削除する
1. 完了（再度稼働させる場合は、利用手順の中のトリガー追加の作業を行ってください）

# 開発資料

## 環境構築

本プログラムでは yarn 及び clasp を利用して開発を行っています。

必要なパッケージをインストールし、clasp に Google アカウントでログインしてください。

```
$ npm install -g @google/clasp
$ clasp login
$ yarn
$ yarn generate
```

## コマンド

ブラウザ上で Apps Script エディタを開く

```
$ yarn open
```

実装した ts ファイルを元に gs ファイルを作成し、AppsScript にアップロードする

```
$ yarn push
```

## 開発後の注意

公開用に dist/app.gs ファイルも合わせて更新するようにしてください
